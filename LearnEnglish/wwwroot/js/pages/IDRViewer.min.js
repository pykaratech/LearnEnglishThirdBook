var IDRViewer=function(){function ki(){k==0?(alert("Portrait Mode, Home Button bottom"),k="portrait"):k==90?k="landscape":k==-90?k="landscape":k==180&&(k="portrait")}function di(){k=window.innerHeight>window.innerWidth?"portrait":"landscape"}var s={},t=1,a=0,it=0,ei,f=0,o=0,u,l,e,h,rt=[],p,v,b=!1,y=!1,ht,ut,ct,ft,bt=!1,kt,dt,lt=0,at=1,vi=2,oi=0,si=1,gt=5,ni=2,vt=3,ti=4,g=0,ii=1,c=3,nt=40,yt=[],ri=0,yi=0,hi="index",r=0,i=0,ci,ui=!0,et,wt,ot,d,ai,tt,n,st;s.makeNavBar=function(k,d,lt,at,pt,wt,bt){"use strict";var ri,kt,dt,wi,tu,rr,gi,ki,ur,iu,su,ru,uu,nu;if(ut=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),ct=/iPhone|iPad|iPod/i.test(navigator.userAgent),ft=ut&&window.requestAnimationFrame&&!(typeof InstallTrigger!="undefined"),l=n("contentContainer"),e=n("mainContent"),v=n("left"),o=k,f=d,a=lt,it=l.clientHeight-6,ei=at,h=pt,ci=bt,n("pgCount").innerHTML="/"+o,l.style.width=a+"px",l.style.height=it+"px",wi=n("goBtn"),h===0){for(u=n("jpedal"),kt=1;kt<=o;kt++)ri=document.createElement("option"),ri.value=kt,ri.innerHTML=String(kt),wi.appendChild(ri);wi.selectedIndex=d-1}else if(h===1){for(u=n("container"+d),n("goBtn").style.width="65px",ri=document.createElement("option"),ri.value=1,ri.innerHTML="1",wi.appendChild(ri),kt=2;kt<=o;kt+=2)ri=document.createElement("option"),ri.value=kt,tu=kt!==o||o%2==1?String(kt+"-"+(kt+1)):String(kt),ri.innerHTML=tu,wi.appendChild(ri);wi.selectedIndex=d/2}else if(h===2){for(u=n("jpedal"),k>1&&scrollEv(null),kt=1;kt<=o;kt++)ri=document.createElement("option"),ri.value=kt,ri.innerHTML=String(kt),wi.appendChild(ri),n("page"+kt).style.margin=ft?"0 0 10px":kt!==o?"0 auto 10px":"0 auto",rr=n("page"+kt),rr.clientWidth!=a&&(ui=!1),rt[kt]={width:rr.clientWidth,height:rr.clientHeight};wi.selectedIndex=d-1}for(u.style.transformOrigin="top left",u.style.webkitTransformOrigin="top left",u.style.msTransformOrigin="top left",u.style.mozTransformOrigin="top left",u.style.oTransformOrigin="top left",u.style.margin="0",gi=n("zoomBtn"),ft||(ki=et("zoom"),ur=parseFloat(ki),ki=="width"?c=ni:ki=="height"?c=vt:ki=="page"?c=ti:ki=="actual"?c=ii:!isNaN(ur)&&ur>0?(c=g,t=ur):c=gt,c=vt,n("zoomBtn").selectedIndex=c,ot(),ui||(gi.remove(5),gi.remove(4),gi.remove(3),gi.remove(2),e.scrollLeft=(l.offsetWidth-e.offsetWidth)/2),window.onresize=ot),iu=document.fullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled,iu||(dt=n("btnFullscreen"),dt.parentNode.removeChild(dt)),p=document.getElementById("leftContent"),pi(wt),kt=0;kt<o;kt++)yt[kt]=!1;if(su=n("thumb"+d),b=!1,y=!1,et("sidebar")==="thumbnails"?(b=!0,y=!1):et("sidebar")==="outlines"&&(b=!0,y=!0,n("btnThumbnails").className="navBtn"),b&&(n("main").style.transitionDuration="0ms",v.style.transitionDuration="0ms",v.style.width="200px",v.style.left="0",v.offsetLeft,n("main").style.transitionDuration="200ms",v.style.transitionDuration="200ms",fi(-1)),y&&(n("thumbnailPanel").style.display="none",n("outlinePanel").style.display="inline"),ht=et("mode")==="pan"?si:oi,this.setSelectMode(ht),tt("fullscreenchange",document,st),tt("MSFullscreenChange",document,st),tt("mozfullscreenchange",document,st),tt("webkitfullscreenchange",document,st),tt("scroll",p,li),f===1&&(n("btnPrev").className="inactive navBtn"),(f===o||h===1&&o%2==1&&f+1===o)&&(n("btnNext").className="inactive navBtn"),ru=document.createElement("script"),document.head.appendChild(ru),ut&&(dt=n("zoomBtn"),dt.parentNode.removeChild(dt),dt=n("btnMove"),dt.parentNode.removeChild(dt),dt=n("btnSelect"),dt.parentNode.removeChild(dt)),ft){dt=n("btnZoomIn");dt.parentNode.removeChild(dt);dt=n("btnZoomOut");dt.parentNode.removeChild(dt);n("contentContainer").style.width="100%";n("contentContainer").style.height="100%";n("contentContainer").style.padding="0";uu=window.innerWidth;t=uu/a;bi=t;ct?setTimeout(function(){w(0,0,t,!1)},0):setTimeout(function(){w(0,0,t,!0);u.style.webkitBackfaceVisibility="hidden"},0);var di,nr,tr,hu,lr,ar,vr,yr=0,pr,hi=0,fr,ai,vi,cu,lu,au,er,vu,yu,wr,or,sr,hr,br,kr,dr,gr,cr,bi,yi=function(n){return Math.round(n*2)/2},fu=function(){if(wr=!0,hi++,!or&&(ai<-.5||ai>.5||vi<-.5||vi>.5))r-=ai,i-=vi,ai=ai*.95,vi=vi*.95,ir(),w(yi(r),yi(i),t,!0),window.requestAnimationFrame(fu,u);else{if(wr=!1,!or){var n=hi;setTimeout(function(){hi===n&&eu()},200)}or=!1}},pu=function(n){var f,e,h,c,l,a;if(hi++,yu=hi,wr&&(or=!0),cu=n.touches[0].clientX,lu=n.touches[0].clientY,au=Date.now(),n.touches.length===2){var o=n.touches[0].clientX,v=n.touches[1].clientX,s=n.touches[0].clientY,y=n.touches[1].clientY;lr=Math.sqrt(Math.pow(Math.abs(o-v),2)+Math.pow(Math.abs(s-y),2));ar=o-(o-v)/2;vr=s-(s-y)/2}if(n.touches.length==1){f=(new Date).getTime();di=di||f+1;var p=f-di,b=Math.abs(nr-n.touches[0].clientX),k=Math.abs(tr-n.touches[0].clientY);p<500&&p>0&&b<50&&k<50?(e=t>bi?bi/t:bi*2/t,h=window.innerWidth/2,c=nt+(window.innerHeight-nt)/2,r=r+(h-nr),i=i+(c-tr),l=-r+h,r=r-(l*e-l),a=-i+c,i=i-(a*e-a),t=t*e,ir(),u.style.transitionDuration="200ms",w(r,i,t,!1),setTimeout(function(){u.style.transitionDuration=""},200),di=0):di=f;nr=n.touches[0].clientX;tr=n.touches[0].clientY;pr=!0}else hu=null;sr=r;hr=i;br=sr;kr=hr;gr=Date.now();dr=Date.now();cr||(cr=setInterval(function(){sr=br;hr=kr;br=r;kr=i;dr=gr;gr=Date.now()},200))},eu=function(){if(fr=!1,v.style.zIndex="5",u.style.webkitBackfaceVisibility="",requestAnimationFrame(function(){w(yi(r),yi(i),t,!1)},u),!ct){var n=hi;setTimeout(function(){u.style.webkitBackfaceVisibility="hidden";hi===n&&(w(yi(r),yi(i),t,!0),b&&(v.style.zIndex="10"))},200)}},ou=function(){var n;if(clearInterval(cr),cr=null,hi++,fr&&(n=hi,setTimeout(function(){hi===n&&eu()},200)),er){er=!1;vu=!1;var t=Date.now()-dr,f=sr-r,e=hr-i;ai=f/(t/16);vi=e/(t/16);Math.abs(ai)<.5&&(ai=0);Math.abs(vi)<.5&&(vi=0);(ai!==0||vi!==0)&&window.requestAnimationFrame(fu,u)}},wu=function(){ou(null)},ir=function(){var n,u;r>0&&(r=0,ai=0);i>0&&(i=0,vi=0);n=a*t;r+n<window.innerWidth&&(r=n>window.innerWidth?window.innerWidth-n:0,ai=0);u=ei*t;nt+i+u<window.innerHeight&&(i=u>window.innerHeight-nt?window.innerHeight-u-nt:0,vi=0)},bu=function(n){var e,o,c,l;if(hi++,n.preventDefault(),n.stopPropagation(),di=0,er=!1,n.touches.length===1&&pr){ct&&(fr=!0);er=!0;var v=n.touches[0].clientX,y=n.touches[0].clientY,d=v-nr,g=y-tr;r=r+d;i=i+g;nr=v;tr=y;ir();requestAnimationFrame(function(){w(yi(r),yi(i),t,!0)},u)}if(n.touches.length===2&&(pr=!1,yr=(yr+1)%2,yr===1)){fr=!0;var s=n.touches[0].clientX,p=n.touches[1].clientX,h=n.touches[0].clientY,b=n.touches[1].clientY,k=Math.sqrt(Math.pow(Math.abs(s-p),2)+Math.pow(Math.abs(h-b),2)),f=k/lr;f<1&&a*t*f<window.innerWidth&&(f=1,t=bi);t*f>4&&(f=1);t=t*f;e=s-(s-p)/2;o=h-(h-b)/2;r=r+e-ar;i=i+o-vr;c=-r+e;r=r-(c*f-c);l=-i+o;i=i-(l*f-l);ir();ar=e;vr=o;requestAnimationFrame(function(){w(yi(r),yi(i),t,!0)},u);lr=k}},ku=function(){setTimeout(function(){bi=window.innerWidth/a;t<=bi&&(t=bi);ir();w(r,i,t,!1)},300)};e.addEventListener("touchstart",pu);e.addEventListener("touchend",ou);e.addEventListener("touchcancel",wu);e.addEventListener("touchmove",bu);window.onorientationchange=ku;nu=function(){var t={},n=!1,i,r;return t.touchStart=function(t){t.touches.length===1?(i=t.touches[0].clientX,r=t.touches[0].clientY,n=!0):n=!1},t.touchMove=function(t){if(n){var u=i-t.touches[0].clientX,f=Math.abs(r-t.touches[0].clientY);f>50?n=!1:u>100&&(n=!1,IDRViewer.toggleThumbnails())}},t}();v.addEventListener("touchstart",nu.touchStart);v.addEventListener("touchmove",nu.touchMove)}$(document).trigger("loadComplete",s)};s.setBookmarks=function(t){n("leftContent").style.top="40px";n("leftNav").style.display="block";n("outlinePanel").innerHTML=t;y?n("btnThumbnails").className="navBtn":n("btnOutlines").className="navBtn"};s.setFirstPageName=function(n){"use strict";hi=n};et=function(n){"use strict";for(var r=document.URL,u=r.toString().indexOf("?"),i=u!=-1?r.substr(u+1).split("&"):"",t=0;t<i.length;t++)if(i[t]=i[t].split("="),i[t][0]==n)return i[t][1];return""};s.toggleOutlines=function(t){"use strict";y&&!t?(n("thumbnailPanel").style.display="inline",n("outlinePanel").style.display="none",p.scrollTop=n("thumb"+f).getBoundingClientRect().top-80,y=!y,n("btnThumbnails").className="inactive navBtn",n("btnOutlines").className="navBtn"):t&&n("btnOutlines").className!="inactive navBtn"&&(n("thumbnailPanel").style.display="none",n("outlinePanel").style.display="inline",y=!y,n("btnThumbnails").className="navBtn",n("btnOutlines").className="inactive navBtn")};var pi=function(n){"use strict";for(var t,f,u=0,i=0,r=1;r<=o;r++)n[i]<0&&u<=0?(u=Math.abs(n[i])-1,i++):u>0?u--:(f=n[i],i++),t=document.createElement("div"),t.style.height=f+"px",t.className="thumbnail",t.id="thumb"+r,t.setAttribute("onclick","IDRViewer.goToPage("+r+");"),t.setAttribute("title","Page "+r),t.innerHTML='<img src="https://majemastoragelive.blob.core.windows.net/learn-english-test/ebook/assets/loading.gif"/>'},wi=function(n){"use strict";yt[n]||(p.children[0].children[n].children[0].setAttribute("src","thumbnails/"+(n+1)+ci),yt[n]=!0)},li=function(){"use strict";var n=p.scrollTop;yi=ri;ri=n;setTimeout(function(){fi(n)},500)},fi=function(n){"use strict";var t,i;if(n==ri||n==-1)for(t=0;t<o;t++)if(!yt[t]){if(i=p.children[0].children[t],i.offsetTop>p.scrollTop+p.clientHeight)break;i.offsetTop+i.clientHeight>p.scrollTop&&wi(t)}};s.setSelectMode=function(t){"use strict";ut||(ht=t,t==oi?(n("btnSelect").className="inactive navBtn",n("btnMove").className="navBtn",l.style.cursor=pt(lt),l.onmousedown=function(){},document.body.onmouseup=function(){},document.body.onmousemove=function(){}):(n("btnSelect").className="navBtn",n("btnMove").className="inactive navBtn",window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),l.style.cursor=pt(at),l.onmousedown=function(n){return n=n||window.event,l.style.cursor=pt(vi),kt=n.clientX,dt=n.clientY,bt=!0,!1},document.body.onmouseup=function(){l.style.cursor=pt(at);bt=!1},document.body.onmousemove=function(n){if(bt)return n=n||window.event,e.scrollLeft=e.scrollLeft+kt-n.clientX,e.scrollTop=e.scrollTop+dt-n.clientY,kt=n.clientX,dt=n.clientY,!1}))};var pt=function(n){"use strict";var t=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,i=typeof InstallTrigger!="undefined",r=!!window.chrome&&!t;return i?n==lt?"":n==at?"-moz-grab":"-moz-grabbing":r?n==lt?"":n==at?"-webkit-grab":"-webkit-grabbing":n==lt?"":"all-scroll"},bi=function(){"use strict";var n=0;return self.innerHeight?n=self.innerWidth:document.documentElement&&document.documentElement.clientHeight?n=document.documentElement.clientWidth:document.body&&(n=document.body.clientWidth),n},w=function(n,t,i,r){"use strict";var f;f=r?"translate3d("+n+"px, "+t+"px, 0) scale("+i+")":"translateX("+n+"px) translateY("+t+"px) scale("+i+")";u.style.transform=f;u.style.webkitTransform=f;u.style.msTransform=f;u.style.MozTransform=f;u.style.OTransform=f;h===2&&scrollEv()},k="landscape";return di(),wt=function(){var f,v,y;window.onorientationchange=ki;"use strict";var d=e.scrollLeft,p=e.scrollTop,b=l.offsetHeight;c===g&&(n("zoomBtn").selectedIndex=g);t>4?t=4:t<.25&&(t=.25);isiPhone()==="ipad"&&(t=.6499,k=="landscape"&&(t=.587));isIE&&(u.style.zoom=t);w(0,0,t,!1);l.style.width=a*t+20+"px";l.style.height=it*t+"px";var i=n("leftSide"),r=n("rightSide"),o=(e.clientWidth-(a*t+20))/2,s=e.clientHeight;i&&(i.style.width=o+"px",i.style.height=s+"px");r&&(r.style.width=o+"px",r.style.height=s+"px");f=Math.floor(t*100);ut||(n("zoomBtn").options[0].innerHTML=f+"%");h==2&&(v=Math.floor(1e4/f),u.style.width=v+"%");y=l.offsetHeight/b;e.scrollTop=p*y},s.zoomIn=function(){"use strict";c=g;t=t*1.2;wt()},s.zoomUpdate=function(){"use strict";c=n("zoomBtn").selectedIndex;c!=g&&ot()},ot=function(){"use strict";var r,i,n,o,u,s=function(){r=e.clientWidth;h==2&&(a=rt[f].width);t=(r-6)/a};switch(c){case gt:a>bi()&&ui?s():t=1;break;case ni:s();break;case vt:i=e.clientHeight;n=(i-6)/it;h==2&&(u=rt[f].height,n=(i-6)/u);t=n;break;case ti:r=e.clientWidth;i=e.clientHeight;h==2&&(a=rt[f].width,u=rt[f].height);o=(r-6)/a;n=(i-6)/it;h==2&&(n=(i-6)/u);t=o>n?n:o;break;case ii:t=1}wt()},s.handleZoom=ot,s.zoomOut=function(){"use strict";c=g;t=t/1.2;wt()},s.goToPage=function(l){"use strict";var k,a,p,v,tt;if(l===0&&(l=h===0||h===2?n("goBtn").selectedIndex+1:n("goBtn").selectedIndex*2+1),l!=f){if(a=[],c!=gt){switch(c){case ni:p="width";break;case vt:p="height";break;case ti:p="page";break;case g:p=t;break;case ii:p="actual"}a[a.length]="zoom="+p}for(b&&!y&&(a[a.length]="sidebar=thumbnails"),b&&y&&(a[a.length]="sidebar=outlines"),ht==si&&(a[a.length]="mode=pan"),v="?",k=0;k<a.length;k++)k>0&&(v=v+"&"),v=v+a[k];v.length==1&&(v="");h===0?(tt=d(l,o),window.open(tt+".html"+v,"_self")):h==1?(tt=ai(l,o),window.open(tt+".html"+v,"_self")):h==2&&(ft?(u.style.transitionDuration="200ms",i=i-n("page"+l).getBoundingClientRect().top+nt,w(r,i,t,!1),setTimeout(function(){u.style.transitionDuration="";s.updateCurrentPage()},200)):(e.scrollTop=e.scrollTop+n("page"+l).getBoundingClientRect().top-45,s.updateCurrentPage()))}},s.updateCurrentPage=function(){"use strict";var t,s,h,i;if(n("page1").getBoundingClientRect().top>0)f=1,n("goBtn").selectedIndex=f-1;else for(t=1;t<=o;t++){var r=n("page"+t).getBoundingClientRect(),u=r.top,e=r.bottom-r.top;if(u<=e*.25&&u>-e*.5){f=t;n("goBtn").selectedIndex=f-1;break}}if(s=n("btnPrev"),h=n("btnNext"),s.className=f===1?"inactive navBtn":"navBtn",h.className=f===o?"inactive navBtn":"navBtn",i=n("thumb"+f),i.className!="thumbnail currentPageThumbnail"){for(t=1;t<=o;t++)n("thumb"+t).className="thumbnail";i.className="thumbnail currentPageThumbnail";p.scrollTop=p.scrollTop+i.getBoundingClientRect().top-80}},d=function(n,t){"use strict";var i=n.toString(),u=t.toString().length-i.length,r;if(n===1)i=hi;else for(r=0;r<u;r++)i="0"+i;return i},ai=function(n,t){"use strict";return n>t&&(n=t),n===1?d(n,t):n%2==0?n===t?d(n,t):d(n,t)+"-"+d(n+1,t):d(n-1,t)+"-"+d(n,t)},s.next=function(){"use strict";h==1?f+1<o&&this.goToPage(f+2):f<o&&this.goToPage(f+1)},s.prev=function(){"use strict";f>1&&this.goToPage(f-1)},tt=function(n,t,i){"use strict";if(t&&t.addEventListener)t.addEventListener(n,i,!1);else if(t&&t.attachEvent)return t.attachEvent("on"+n,i)},n=function(n){return document.getElementById(n)},s.toggleThumbnails=function(){"use strict";b?(v.style.width="0",v.style.left="-20px"):(fi(-1),v.style.width="200px",v.style.left="0",li());b=!b},st=function(){"use strict";n("btnFullscreen").className=document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?"navBtn open":"navBtn closed"},s.toggleFullScreen=function(){"use strict";document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():document.body.requestFullscreen?document.body.requestFullscreen():document.body.msRequestFullscreen?document.body.msRequestFullscreen():document.body.mozRequestFullScreen?document.body.mozRequestFullScreen():document.body.webkitRequestFullscreen&&document.body.webkitRequestFullscreen()},s.addToolBarHyperlink=function(t,i){"use strict";var u=new Image,r;u.src=t;r=document.createElement("a");r.href=i;r.className="customNavLink";r.appendChild(u);r.setAttribute("target","_blank");n("mainNav").insertBefore(r,n("btnPrev"))},s}();intLoaded?idrLoad():extLoaded=!0;