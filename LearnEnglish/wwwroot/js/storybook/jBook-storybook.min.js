
function d(e) { return document.getElementById(e) } function divResize(e, t, n) { e.style.width = t + "px", e.style.height = n + "px" } function newDiv(e) { var t = document.createElement("div"); return t.setAttribute("id", e), t } function newFrame(e) { var t = document.createElement("iframe"); return t.setAttribute("id", e), t } function z(e, t) { e.style.zIndex = t } function hideVis(e) { e.style.visibility = "hidden" } function showVis(e) { e.style.visibility = "visible" } function noneDisplay(e) { e.style.display = "none" } function inDisplay(e) { e.style.display = "inherit" } function divOriginate(e, t, n) { e.style.webkitTransformOrigin = t + "px " + n + "px", e.style.transformOrigin = t + "px " + n + "px", e.style.mozTransformOrigin = t + "px " + n + "px", e.style.msTransformOrigin = t + "px " + n + "px", e.style.oTransformOrigin = t + "px " + n + "px" } function divMove(e, t, n) { t = parseInt(t), n = parseInt(n), e.style.top = n + "px", e.style.left = t + "px" } function divTranslate(e, t, n, i) { e.style.transform = "translate3d(" + t + "px, " + n + "px, 0px) scale(" + i + ")", e.style.webkitTransform = "translate3d(" + t + "px, " + n + "px, 0px) scale(" + i + ")", e.style.mozTransform = "translate3d(" + t + "px, " + n + "px, 0px) scale(" + i + ")", e.style.msTransform = "translate3d(" + t + "px, " + n + "px, 0px) scale(" + i + ")", e.style.oTransform = "translate3d(" + t + "px, " + n + "px, 0px) scale(" + i + ")" } function pointMove(e, t) { e.style.left = t.x + "px", e.style.top = t.y + "px" } function pointDrag(e, t) { e.style.transitionProperty = "left", e.style.transitionDuration = "300ms", e.style.transitionTimingFunction = "linear", e.style.left = t.x + "px", e.style.transitionProperty = "top", e.style.transitionDuration = "300ms", e.style.transitionTimingFunction = "linear", e.style.top = t.y + "px" } function showDrags() { dragElement.style.visibility = "visible", clipElement.style.visibility = "visible", d("main").style.overflow = "hidden" } function hideDrags() { dragElement.style.visibility = "hidden", clipElement.style.visibility = "hidden" } function makeOne() { } function hideDragsAnim() { isIE ? (dragElement.style.visibility = "hidden", clipElement.style.visibility = "hidden") : (dragElement.style.transitionProperty = "visibility", dragElement.style.transitionDuration = "200ms", dragElement.style.transitionTimingFunction = "linear", dragElement.style.visibility = "hidden", clipElement.style.transitionProperty = "visibility", clipElement.style.transitionDuration = "200ms", clipElement.style.transitionTimingFunction = "linear", clipElement.style.visibility = "hidden") } function rotateSlide(e, t) { e.style.transitionProperty = "rotate", e.style.transitionDuration = "5000ms", e.style.transitionTimingFunction = "linear", e.style.transform = "rotate(" + t + "deg)", e.style.webkitTransform = "rotate(" + t + "deg)", e.style.mozTransform = "rotate(" + t + "deg)", e.style.msTransform = "rotate(" + t + "deg)", e.style.oTransform = "rotate(" + t + "deg)" } function divTurn(e, t, n, i) { i = i.toFixed(3), t = t.toFixed(3), n = (n -= 15).toFixed(3), e.style.transform = "translate3d(" + t + "px, " + n + "px, 1px) rotate(" + i + "deg)", e.style.webkitTransform = "translate3d(" + t + "px, " + n + "px, 1px) rotate(" + i + "deg)", e.style.mozTransform = "translate3d(" + t + "px, " + n + "px, 1px) rotate(" + i + "deg)", e.style.msTransform = "translate3d(" + t + "px, " + n + "px, 1px) rotate(" + i + "deg)", e.style.oTransform = "translate3d(" + t + "px, " + n + "px, 1px) rotate(" + i + "deg)" } function addCSS(e, t) { var n = e.getAttribute("style"); null != n ? e.setAttribute("style", n + t) : e.setAttribute("style", t) } function getCompStyle(e, t) { return window.getComputedStyle(e, null).getPropertyValue(t) } function getHypot(e, t) { return Math.sqrt(e * e + t * t) } function getRadian(e) { return e * Math.PI / 180 } function getDegree(e) { return e / Math.PI * 180 } function getFloat(e) { var t = parseFloat(e); return null === t || isNaN(t) ? 0 : t } function Point(e, t) { this.x = e, this.y = t } function getInt(e) { var t = parseFloat(e); return null === t || isNaN(t) ? 0 : t } function p2p(e, t) { return Math.sqrt((e.x - t.x) * (e.x - t.x) + (e.y - t.y) * (e.y - t.y)) } var userTop, userLeft, userRight, userBottom, PLT, PRT, PLB, PRB, f, SB, ST, dragElement, clipElement, gradElement, innerClip, dlt, drt, drb, dlb, imgFileType, googletag, container, bookDiv, leftDiv, rightDiv, leftMask, rightMask, leftSlides, rightSlides, isIos, aPrefix, definedX, definedY, definedW, definedh, visibleScreenW, fileType = "html", contentPath = "", BOOKWIDTH = 0, BOOKHEIGHT = 0, CLIPDIFF = 0, BY = 8, BX = 26, screenW = 0, isZoomed = !1, zoomRate = 1, currentDrag = 3, bookX = 0, bookY = 0, bgColor = "white", boardColor = "white", bgImgUrl = "../../Content/bg.png", pw = 0, ph = 0, iter = 15, pages = new Array, TH = 10, isTouch = !1, touchStartX = 0, touchStartY = 0, lastX = 0, lastY = 0, toAnimX = 0, toAnimY = 0, STX = 0, STY = 0, SBX = 0, SBY = 0, INRAD = 0, OUTRAD = 0, nextX = 2, pageCount = 0, dragBox = -1, curRP = 1, isTurning = !1, pageDom = new Array, isAnalytics = !1, adjustSpacing = !0, tBarH = 50, isIE = !1, isSafari = !1, leftLoaded = !1, rightLoaded = !1, CX = 0, CY = 0, frameRate = 10, speed = 1, TBH = 0; function screenFix() { divOriginate(d("userRight"), 0, 0), divOriginate(container, 0, 0); var e = parseInt(getCompStyle(d("userRight"), "width")), t = parseInt(getCompStyle(d("userRight"), "Height")), n = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth || 0; n -= 10; var i = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight || 0; i -= 10; var o = BOOKWIDTH + 2 * BX, r = 2 * (50 + TH + BY) + BOOKHEIGHT, a = getInt(getCompStyle(d("userTop"), "height")) + TBH, s = Math.min(n / o, (i - a) / r), l = getInt(getCompStyle(d("userTop"), "width")); divMove(d("userTop"), l < n ? (n - l) / 2 : 0, TBH); var u = a, c = (n -= e * (zoomRate = s)) / 2; c = s * o > n ? 15 : (n - s * o) / 2 + 15, divMove(container, parseInt(c), u + 10), zoomIn(container, zoomRate); var g = getInt(getCompStyle(d("userBottom"), "width")), p = a + r * zoomRate; divMove(d("userBottom"), g < n ? (n - g) / 2 : 0, p); var m = Math.floor(100 * zoomRate) + "%"; d("zoomer").options[0].textContent = m, d("zoomer").selectedIndex = 0, zoomIn(d("userRight"), 1), $("html").hasClass("safari") && $("#footer").height(8 * $(window).height() / 100 + "px"), e > 0 && (zoomIn(d("userRight"), zoomRate), divMove(d("userRight"), c + o * zoomRate + 5, u + r * zoomRate / 2 - t * zoomRate / 2)); var f = ($("#main").height() - $("#footer").height() - $("#container").height() * zoomRate) / 2; if ($("#container,.depth.right,.depth.left").css("top", f + "px"), isIE && 9 === IEVersion) { f = ($("#main").height() - $("#footer").height() - $("#container").height()) / 2; $("#container,.depth.right,.depth.left").css("top", f + "px") } } var prevZoomW = 0; function zoomCtrl(e) { divOriginate(container, 0, 0); var t = window.pageXOffset, n = window.pageYOffset; new Array("userTop", "userBottom", "userLeft", "userRight"); d("userTop"), d("userBottom"); var i = parseInt(getCompStyle(d("userRight"), "width")), o = parseInt(getCompStyle(d("userRight"), "Height")), r = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth || 0; r -= 10; var a = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight || 0; a -= 10; var s = BOOKWIDTH + 2 * BX, l = 2 * (TH + BY) + BOOKHEIGHT, u = (Math.min(r / s, (a - 0) / l), l * zoomRate); "reset" === e ? window.location.reload() : "plus" === e ? zoomRate += .1 : "minus" === e && zoomRate > .1 && (zoomRate -= .1), r -= zoomRate * i, zoomIn(d("container"), zoomRate); var c = s * zoomRate, g = (c - r) / 2, p = l * zoomRate, m = 0; if (c > r) { m = 5; var f = 0 === n ? 0 : (p - u) / 2; window.scrollTo(t + g - prevZoomW, n + f), prevZoomW = g } else m = (r - c) / 2 + 5; var h = TBH + 0; divMove(container, m, h), null !== d("userBottom") && divMove(d("userBottom"), m + (c - 0) / 2, h + p), null !== d("userTop") && divMove(d("userTop"), m + (c - 0) / 2, TBH), zoomIn(d("userRight"), 1), i > 0 && (zoomIn(d("userRight"), zoomRate), divMove(d("userRight"), m + s * zoomRate + 5, h + l * zoomRate / 2 - o * zoomRate / 2)); var v = Math.floor(100 * zoomRate) + "%"; d("zoomer").options[0].textContent = v, d("zoomer").selectedIndex = 0 } window.onresize = function () { isMobile || screenFix() }; var isMobile = !1; function makeAjaxPage(e, t, n, i, o, r, a) { contentPath = a, fileType = e, imgFileType = r, isAjax = !0, isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent), isIos = /iPhone|iPad|iPod/i.test(navigator.userAgent), pageCount = t, addCSS(d("main").parentNode, "background-color:" + bgColor + ";"), BOOKWIDTH = 2 * n, BOOKHEIGHT = i, pageDom[0] = "", aPrefix = o, userTop = d("userTop"), userRight = d("userRight"), userBottom = d("userBottom"), userLeft = d("userLeft"), addCSS(userTop, "position:absolute;z-index:10;"), addCSS(userRight, "position:absolute;z-index:10;"), addCSS(userBottom, "position:absolute;z-index:10;"), addCSS(userLeft, "position:absolute;z-index:10;"), definedX = getInt(getCompStyle(userLeft, "width")), definedY = tBarH + getInt(getCompStyle(userTop, "height")), null != aPrefix && aPrefix.toString().length > 0 && (isAnalytics = !0), "Microsoft Internet Explorer" == navigator.appName && (isIE = !0, frameRate = 5, speed = 1); var s = navigator.userAgent.toLowerCase(); -1 == s.indexOf("safari") || s.indexOf("chrome") > -1 || (isSafari = !0, frameRate = 25, speed = 1), -1 != navigator.userAgent.indexOf("Firefox") && (frameRate = 25, speed = 10), (isTouch = "ontouchstart" in window) && (iter = 25), definedW = n, definedH = i, makeMenuBar(), $(".footerContent").prepend($("#jplayer")), addCSS(d("main"), "position:absolute;top:0;left:0;right:0;bottom:0;"), document.onkeydown = keyNav, makeBook() } var makeMenuBar = function () { var e = document.createElement("img"); e.setAttribute("id", "zoomPlus"), e.setAttribute("src", "https://majemastoragelive.blob.core.windows.net/learn-english-test/content/pgZoomOut.png"), e.setAttribute("onclick", "zoomCtrl('minus')"), addCSS(e, "margin-right:10px;cursor:pointer;border: solid 1px #fff;-webkit-border-radius: 5px;-moz-border-radius:5px;border-radius:5px;vertical-align:bottom;height:32px;"); var t = document.createElement("select"), n = document.createElement("option"); n.value = "100", n.innerText = "100%"; var i = document.createElement("option"); i.value = "reset", i.innerText = "Reset", t.appendChild(n), t.appendChild(i), t.setAttribute("id", "zoomer"), addCSS(t, "color:#383B3B;margin-right:10px;background-color:#B0B0B0;border: solid 2px #fff;-webkit-border-radius: 5px;-moz-border-radius:5px;border-radius:5px;"), divResize(t, 75, 32), t.onchange = function () { 1 === this.selectedIndex && zoomCtrl("reset") }; var o = document.createElement("img"); o.setAttribute("id", "zoomPlus"), o.setAttribute("src", "https://majemastoragelive.blob.core.windows.net/learn-english-test/content/pgZoomIn.png"), o.setAttribute("onclick", "zoomCtrl('plus')"), addCSS(o, "margin-right:15px;cursor:pointer;border: solid 1px #fff;-webkit-border-radius: 5px;-moz-border-radius:5px;border-radius:5px;vertical-align:bottom;height:32px;"); var r = document.createElement("img"); r.setAttribute("id", "thumbBtn"), r.setAttribute("title", "Thumbnails view"), r.setAttribute("src", "https://majemastoragelive.blob.core.windows.net/learn-english-test/content/pgThumbs.png"), r.setAttribute("onclick", "handleThumbnail()"), addCSS(r, "margin-right:10px;cursor:pointer;border: solid 1px #fff;-webkit-border-radius: 5px;-moz-border-radius:5px;border-radius:5px;vertical-align:bottom;height:32px;"); var a = document.createElement("img"); a.setAttribute("id", "backward"), a.setAttribute("src", "https://majemastoragelive.blob.core.windows.net/learn-english-test/content/pgBegin.png"), a.setAttribute("title", "Go To The First Page"), addCSS(a, "margin-right:10px;cursor:pointer;border: solid 1px #fff;-webkit-border-radius: 5px;-moz-border-radius:5px;border-radius:5px;vertical-align:bottom;height:32px;"), a.onclick = function (e) { turnFirst(e) }; var s = document.createElement("img"); s.setAttribute("id", "prev"), s.setAttribute("src", "https://majemastoragelive.blob.core.windows.net/learn-english-test/content/pgPrev.png"), s.setAttribute("title", "Go To Previous Page"), addCSS(s, "margin-right:10px;cursor:pointer;border: solid 1px #fff;-webkit-border-radius: 5px;-moz-border-radius:5px;border-radius:5px;vertical-align:bottom;height:32px;"), s.onclick = function (e) { turnPrev(e) }; var l = document.createElement("select"); l.setAttribute("id", "goBtn"); for (var u = pageCount / 2, c = 0; c <= u; c++){ var g; g = 0 === c ? 1 : c === u ? 2 * c : 2 * c + "-" + (2 * c + 1); var p = document.createElement("option"); p.setAttribute("value", g), p.textContent = g, l.appendChild(p) } l.setAttribute("onchange", "goToPage()"), addCSS(l, "margin-right:5px;border: solid 2px #fff;background-color:#B0B0B0;color:#383B3B;text-align:center"), addCSS(l, "-webkit-border-radius: 6px ;-moz-border-radius: 6px;border-radius: 6px;"), divResize(l, 75, 32); var m = document.createElement("span"); addCSS(m, "color:white;margin-right:5px;"), m.innerHTML = "/ " + pageCount; var f = document.createElement("img"); f.setAttribute("id", "next"), f.setAttribute("src", "https://majemastoragelive.blob.core.windows.net/learn-english-test/content/pgNext.png"), f.setAttribute("title", "Go To Next Page"), addCSS(f, "margin-right:10px;cursor:pointer;border: solid 1px #fff;-webkit-border-radius: 5px;-moz-border-radius:5px;border-radius:5px;vertical-align:bottom;height:32px;"), f.onclick = function (e) { turnNext(e) }; var h = document.createElement("img"); h.setAttribute("id", "forward"), h.setAttribute("src", "https://majemastoragelive.blob.core.windows.net/learn-english-test/content/pgLast.png"), h.setAttribute("title", "Go To The Last Page"), addCSS(h, "margin-right:10px;cursor:pointer;border: solid 1px #fff;-webkit-border-radius: 5px;-moz-border-radius:5px;border-radius:5px;vertical-align:bottom;height:32px;"), h.onclick = function (e) { turnLast(e) }; var v = newDiv("menuBar"), x = newDiv("menuBarDiv"); if (x.appendChild(v), addCSS(x, "position:fixed;padding:5px;z-index:20;width:100%;"), divMove(x, 0, 0), null != d("userImageLink")) { var y = d("userImageLink").innerHTML, b = d("userWebLink").innerHTML, T = document.createElement("a"); T.setAttribute("href", b), T.setAttribute("target", "_blank"), T.innerHTML = "<img src='" + y + "' id='userImg' style='position:absolute;left:5px;height:30px;top:5px;'/>", x.appendChild(T) } for (var P = [e, t, o, a, s, l, m, f, h], B = 0; B < P.length; B++)v.appendChild(P[B]); addCSS(v, "vertical-align: middle;position:relative;margin: 0 auto;font-family:Arial;font-size:14px;width:560px;"); getInt(window.getComputedStyle(v, null).getPropertyValue("height")); d("main").parentNode.appendChild(x) }; function makeBook() { var e = window.innerWidth; window.innerHeight; visibleScreenW = getInt(getCompStyle(d("main"), "width")); var t = newDiv("thumbnailDiv"); addCSS(t, "overflow-y:scroll;z-index:20;position:fixed;top:" + TBH + "px;left:-200px;width:200px;height:95%;background-color:black;opacity:0.9;"), document.body.appendChild(t), CLIPDIFF = BOOKWIDTH / 2, bookY = 0 + BY, pw = BOOKWIDTH / 2, ph = BOOKHEIGHT, (leftDiv = newFrame("leftDiv")).scrolling = "no", leftDiv.onload = function (e) { leftLoaded = !0, hideTurns() }, addCSS(leftDiv, "position:absolute;background-color:" + boardColor + ";overflow:hidden;"), divResize(leftDiv, BOOKWIDTH / 2, BOOKHEIGHT), divMove(leftDiv, BX + 16, BY + TH), addCSS(leftMask = newDiv("leftMask"), "position:absolute;overflow:hidden;z-index:-4;"), divResize(leftMask, BOOKWIDTH / 2, BOOKHEIGHT), divMove(leftMask, BX, BY + TH), (rightDiv = newFrame("rightDiv")).scrolling = "no", rightDiv.onload = function (e) { rightLoaded = !0, hideTurns() }; var n = newDiv("middleDiv"); addCSS(n, "position:absolute;border:solid #5A5A5A 0.5px;"), divResize(n, 1, BOOKHEIGHT), divMove(n, BX + BOOKWIDTH / 2 - 26, 3), addCSS(rightDiv, "position:absolute;overflow:hidden;"), divResize(rightDiv, BOOKWIDTH / 2, BOOKHEIGHT), divMove(rightDiv, BX + BOOKWIDTH / 2 - 16, BY + TH), addCSS(rightMask = newDiv("rightMask"), "position:absolute;overflow:hidden;z-index:-4;"), divResize(rightMask, BOOKWIDTH / 2, BOOKHEIGHT), divMove(rightMask, BX + BOOKWIDTH / 2, BY + TH), addCSS(leftSlides = newDiv("leftSlides"), "position:absolute;background-color:" + boardColor + ";z-index:20;"), addCSS(leftSlides, "-webkit-border-top-left-radius: 9px;-moz-border-radius-topleft: 9px;border-top-left-radius: 9px;"), addCSS(leftSlides, "-webkit-border-bottom-left-radius: 9px;-moz-border-radius-bottomleft: 9px;border-bottom-left-radius:9px;"), divResize(leftSlides, BX, BOOKHEIGHT + 2 * BY), divMove(leftSlides, 0, TH), rightSlides = newDiv("rightSlides"), clipElement = newDiv("clip"), dragElement = newDiv("drag"), gradElement = newDiv("grad"), clipContent = newDiv("clipContent"), innerClip = newDiv("innerClip"), addCSS(dragElement, "position:absolute;z-index:3;box-shadow:0px 0px 10px #888888;background-color:#ffffff;"), addCSS(clipElement, "position:absolute;background-color:" + bgColor + ";overflow:hidden;z-index:4;box-shadow:0px 0px 100px #5A5A5A;"), addCSS(innerClip, "position:relative;background-color:" + boardColor + ";overflow:hidden;padding-top:" + BY + "px;"), addCSS(innerClip, "-webkit-border-top-right-radius: 9px;-moz-border-radius-topright: 9px;border-top-right-radius: 9px;"), addCSS(innerClip, "-webkit-border-bottom-right-radius: 9px;-moz-border-radius-bottomright: 9px;border-bottom-right-radius:9px;"), addCSS(clipContent, "background-color:white;overflow:hidden;"), divResize(dragElement, BOOKWIDTH / 2, BOOKHEIGHT), divResize(clipElement, BOOKWIDTH / 2 + 2 * CLIPDIFF, BOOKHEIGHT + 2 * CLIPDIFF), divResize(innerClip, BOOKWIDTH / 2 + BX, BOOKHEIGHT + BY), divResize(clipContent, BOOKWIDTH / 2, BOOKHEIGHT), innerClip.appendChild(clipContent), clipElement.appendChild(innerClip), makeInvisible(clipElement, !1), makeInvisible(dragElement, !1), divResize(container = d("container"), BOOKWIDTH + 2 * BX * 0, 2 * (TH + BY) * 0 + BOOKHEIGHT), addCSS(container, "position:absolute;background-color:" + bgColor + ";overflow:hidden;"); for (var i = [], o = 0; o < i.length; o++)container.appendChild(i[o]); var r = getInt(window.getComputedStyle(d("userBottom"), null).getPropertyValue("width")), a = 2 * (TH + BY) + BOOKHEIGHT + CY; divMove(d("userBottom"), r < e ? (e - r) / 2 : 0, a * zoomRate), PLT = new Point(BX, BY + TH), PRT = new Point(PLT.x + BOOKWIDTH, PLT.y), PLB = new Point(PLT.x, PLT.y + BOOKHEIGHT), PRB = new Point(PRT.x, PLT.y + BOOKHEIGHT), dlt = newDiv("dlt"), dlb = newDiv("dlb"), drt = newDiv("drt"), drb = newDiv("drb"); var s = []; for (o = 0; o < s.length; o++){ var l = s[o]; addCSS(l, isIE || isTouch ? "position:absolute;background-color: rgb(229, 229, 229);opacity:0.1;z-index:10;" : "position:absolute;z-index:10;background-color: rgb(229, 229, 229);opacity:0.1;"), divResize(l, 100, 100), container.appendChild(l) } if (pointMove(dlt, PLT), divMove(dlb, PLB.x, PLB.y - 100), divMove(drt, PRT.x - 100, PRT.y), divMove(drb, PRB.x - 100, PRB.y - 100), addListeners(), updateTweet(), getJumpQuery(), getPage(rightDiv, curRP), getPage(leftDiv, curRP - 1), updateSlides(), window.setTimeout(function () { screenFix() }, 1), isAnalytics && null != _gaq) { var u = aPrefix + "/" + (curRP - 1) + (curRP <= pageCount ? "-" + curRP : ""); _gaq.push(["_trackPageview", u]) } document.onclick = function (e) { (null != e.target ? e.target : e.srcElement).id }, getPageAsImage(clipContent, 2), getPageAsImage(dragElement, 3), window.setTimeout(function () { updateThumbnail(), scrollThumbnail() }, 1) } function hideTurns() { leftLoaded && rightLoaded && (makeInvisible(clipElement, !1), makeInvisible(dragElement, !1), leftLoaded = !1, rightLoaded = !1, d("main").style.overflow = "") } function updateThumbnail() { } function updateThumbnail1() { for (var e = d("thumbnailDiv"), t = "<div style='margin:10px 0px 5px 10px;color:white;'>", n = 0; n < pageCount; n++){ 0 == n && (t += "<span style='width:80px;display:inline-block;'></span>"), t = t + "<img id='jThumb" + (n + 1) + "' src = 'thumbnails/" + (n + 1) + imgFileType + "' width='80px' style='cursor:pointer;' onclick='jumpPage(" + ((n + 1) % 2 == 1 ? n + 1 : n + 2) + ")'/>", (n + 1) % 2 == 1 && (t = t + "<div style='text-align:center;height:25px;'>" + n + "-" + (n + 1) + "</div>") } t += "<p style='color:white;text-align:center;'>End Of Pages</p></div>", e.innerHTML = t } function handleThumbnail() { } function handleThumbnail1() { var e = d("thumbnailDiv"); e.style.transitionProperty = "left", e.style.transitionDuration = "300ms", e.style.transitionTimingFunction = "linear", 0 === getInt(getCompStyle(e, "left")) ? e.style.left = "-200px" : e.style.left = "0px" } function hideShare() { } function handleShareMenu(e) { } function goToPage(e) { var t = 2 * d("goBtn").selectedIndex + 1; t !== curRP && (t < curRP ? (curRP = t + 2, updateMethod("minus")) : (curRP = t - 2, updateMethod("plus")), updateSlides()) } function jumpPage(e) { e !== curRP && (e < curRP ? (curRP = e + 2, updateMethod("minus")) : (curRP = e - 2, updateMethod("plus")), updateSlides()) } function updateTweet() { var e = document.URL; e.toString().indexOf("#page") > -1 && (e = e.substr(0, e.toString().indexOf("#page"))), e = e + "#page=" + curRP; encodeURIComponent("" + e), encodeURIComponent("I am reading Magazine " + e) } function getJumpQuery() { var e = document.URL, t = e.toString().indexOf("#page="); if (-1 !== t) { var n = parseInt(e.substr(t + "#page=".length, e.length)); n > pageCount ? curRP = pageCount % 2 == 0 ? pageCount - 1 : pageCount : n < 1 ? (alert("invalid page number"), curRP = 1) : curRP = n % 2 == 0 ? n + 1 : n } } function removeHighlights1() { $("#rightDiv,#leftDiv").contents().find(".highlight").removeClass(highlightClass) } function checkRightLoaded() { "complete" !== (rightDiv.contentDocument || ele.contentWindow.document).readyState ? window.setTimeout("checkRightLoaded()", 100) : removeHighlights1() } function checkLeftLoaded() { "complete" !== (leftDiv.contentDocument || ele.contentWindow.document).readyState ? window.setTimeout("checkLeftLoaded()", 100) : removeHighlights1() } function fireLoad(e) { if (document.createEvent) { var t = document.createEvent("MouseEvents"); t.initEvent("load", !0, !1), e.dispatchEvent(t) } else document.createEventObject ? e.fireEvent("onload") : "function" == typeof e.onclick && e.onload() } function turnNext(e) { hideShare(), canMove("plus") && !isTurning && (setDragBox(3), swipePages(e, !0)) } function turnPrev(e) { hideShare(), canMove("minus") && !isTurning && (setDragBox(4), swipePages(e, !0)) } function turnFirst(e) { hideShare(), canMove("minus") && !isTurning && (leftSlides.textContent = "", curRP = 3, setDragBox(1), swipePages(e, !0)) } function turnLast(e) { hideShare(), canMove("plus") && !isTurning && (rightSlides.textContent = "", curRP = pageCount % 2 == 0 ? pageCount - 1 : pageCount - 2, setDragBox(2), swipePages(e, !0)) } function updateSlides() { var e = 8, t = curRP - 3; pageCount - curRP < 10 && (e = pageCount - curRP - 1); for (var n = "", i = "", o = 0; o < e; o++)n = n + "<div style='position:absolute;width:1px;height:" + (BOOKHEIGHT - 2 * o) + "px;top:" + (o + BY) + "px;left:" + 2 * o + "px;background-color:white;'></div>"; curRP > 10 && (t = 10); for (var r = 0; r < t; r++)i = i + "<div style='position:absolute;width:1px;height:" + (BOOKHEIGHT - 2 * r) + "px;top:" + (r + BY) + "px;left:" + (BX - 2 * r) + "px;background-color:white;'></div>"; d("goBtn").selectedIndex = curRP / 2, rightSlides.innerHTML = n, leftSlides.innerHTML = i, scrollThumbnail(), seekAudio(curRP) } var pageToMove = 0; function seekAudio(e) { } function scrollThumbnail() { } function scrollThumbnail1() { window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight; if (d("jThumb1")) { var e = getInt(getCompStyle(d("jThumb1"), "height")); d("thumbnailDiv").scrollTop = (curRP - 1) / 2 * (e + 26) } } function updateZoom() { var e = window.pageXOffset, t = window.pageYOffset, n = container.getBoundingClientRect().height; jpedal.style.transform = "scale(" + zoom + ")", jpedal.style.WebkitTransform = "scale(" + zoom + ")", jpedal.style.msTransform = "scale(" + zoom + ")", jpedal.style.MozTransform = "scale(" + zoom + ")", jpedal.style.OTransform = "scale(" + zoom + ")", d("container").style.width = width * zoom + "px", d("container").style.height = height * zoom + "px"; var i = Math.floor(100 * zoom) + "%"; d("zoomBtn").options[0].textContent = i, d("zoomBtn").selectedIndex = 0; var o = container.getBoundingClientRect().height / n; window.scrollTo(e, t * o) } function handleZoom() { hideShare(); var e = new Array("userTop", "userBottom", "userLeft", "userRight"); divOriginate(container, 0, 0); for (var t = document.getElementsByTagName("img"), n = 0; n < t.length; n++)addCSS(t[n], "image-rendering: optimizeQuality;-ms-interpolation-mode: bicubic;"); if (isZoomed) { for (var i = 0; i < e.length; i++)makeDisplay(d("" + e[i]), !0); divMove(d("container"), 0, 0), zoomIn(d("container"), 1), isEC && (makeAdDisplay(d("div-gpt-ad-1368107322398-1"), !0), makeAdDisplay(d("div-gpt-ad-1368107322398-0"), !0)), isZoomed = !1 } else { for (n = 0; n < e.length; n++)makeDisplay(d("" + e[n]), !1); divMove(d("container"), -1.4 * bookX + tBarH, -1.4 * bookY + 1.4 * tBarH), zoomIn(d("container"), 1.4), isZoomed = !0 } } function addListeners() { var e = new Array(dlt, drt, drb, dlb); if (isTouch) for (var t = 0; t < e.length; t++)e[t].addEventListener("touchstart", function (e) { e.preventDefault(), touchStartX = getScrollMX(e), touchStartY = getScrollMY(e), initDragDrop(e) }, !1), e[t].addEventListener("touchmove", function (e) { movePages(e) }, !1), e[t].addEventListener("touchend", function (e) { swipePages(e, !0) }, !1), e[t].addEventListener("click", function (e) { swipePages(e, !0) }, !1); else for (var n = 0; n < e.length; n++)e[n].addEventListener("mousedown", function (e) { initDragDrop(e) }, !1); for (var i = 0; i < e.length; i++)e[i].addEventListener("click", function (e) { swipePages(e, !0) }, !1), e[i].addEventListener("dblclick", function (e) { swipePages(e, !0) }, !1) } function removeListeners() { dlt.onclick = null, drt.onclick = null, drb.onclick = null, dlb.onclick = null } function initDragDrop(e) { var t = 0; null == e && (e = window.event); var n = (null != e.target ? e.target : e.srcElement).getAttribute("id"); t = "dlt" == n ? 1 : "drt" == n ? 2 : "drb" == n ? 3 : 4, isTouch || (document.onmousedown = turnStart, document.onmouseup = turnEnd), currentDrag = t, setDragBox(t) } function turnStart(e) { null == e && (e = window.event); var t = null != e.target ? e.target : e.srcElement; if (1 == e.button && null != window.event || 0 == e.button) return document.onmousemove = onMouseMove, document.body.focus(), t.ondragstart = function () { return !1 }, !1 } function updateDragClip(e) { "plus" === e ? (curRP + 1 >= 1 && curRP + 1 <= pageCount ? getPageAsImage(dragElement, curRP + 1) : dragElement.textContent = "", curRP + 2 >= 1 && curRP + 2 <= pageCount ? getPageAsImage(clipContent, curRP + 2) : (clipContent.textContent = "", clipContent.style.backgroundColor = boardColor)) : curRP >= 3 && (getPageAsImage(dragElement, curRP - 2), curRP > 3 ? getPageAsImage(clipContent, curRP - 3) : (clipContent.style.backgroundColor = boardColor, clipContent.textContent = "")) } function exchange(e, t) { null !== e && null !== t && (t.innerHTML = e.innerHTML) } function doNextXpages(e, t) { if (!isIE) { for (var n = newDiv("ele"), i = e; i <= t; i++)i < pageCount && getPage(n, i); n.textContent = "" } } function doPrevXpages(e, t) { if (!isIE) { for (var n = newDiv("ele"), i = e; i > t; i--)i > 0 && getPage(n, i); n.textContent = "" } } function canTurnPlus() { var e = !0, t = pageCount % 2 == 0; return (!t && curRP === pageCount || t && curRP - 1 === pageCount) && (e = !1), e } function canTurnMinus() { var e = !0; return 1 === curRP && (e = !1), e } function adjustGivenPage(e) { var t = document.getElementById("ld" + e); null !== t && (window.eval(t.innerHTML), window["load" + e]()) } function updateMethod(e) { hideMasks(), null == googletag || null == googletag.pubads || isZoomed || googletag.cmd.push(googletag.pubads().refresh()); var t = pageCount % 2 == 0; if (1 === curRP && (leftDiv.style.backgroundColor = boardColor, leftDiv.src = ""), "plus" === e) { if (!canTurnPlus()) return; if (curRP > 2 && (leftDiv.style.backgroundColor = "white"), getPage(leftDiv, curRP + 1), getPage(rightDiv, curRP + 2), t ? curRP + 2 === pageCount && (rightDiv.src = "", rightDiv.style.backgroundColor = boardColor) : curRP + 1 === pageCount && (rightDiv.src = "", rightDiv.style.backgroundColor = boardColor), (curRP += 2) >= pageCount && (rightDiv.style.backgroundColor = boardColor), isAnalytics) { var n = aPrefix + "/" + (curRP - 1) + (curRP <= pageCount ? "-" + curRP : ""); _gaq.push(["_trackPageview", n]) } } else if ((curRP -= 2) < 1 && (curRP = 1), getPage(leftDiv, curRP - 1), getPage(rightDiv, curRP), 1 === curRP && (leftDiv.textContent = "", leftDiv.style.backgroundColor = boardColor), isAnalytics) { n = aPrefix + "/" + (curRP - 1) + (curRP <= pageCount ? "-" + curRP : ""); _gaq.push(["_trackPageview", n]) } } function makeNavBtnDisable() { prev.setAttribute("disabled", "disabled"), next.setAttribute("disabled", "disabled") } function makeNavBtnEnable() { prev.removeAttribute("disabled"), next.removeAttribute("disabled") } function getPageAsImage(e, t) { } function getPageAsImage1(e, t) { t > pageCount || t < 1 ? e.textContent = "" : e.innerHTML = "<img src='" + contentPath + "turnImages/" + t + imgFileType + "' width='100%' style='-webkit-backface-visibility: hidden;'/>" } function getPage(e, t) { e.src = "", e.src = t > pageCount || t < 1 ? "" : contentPath + "" + pageURL(t, pageCount) + "." + fileType } function getViewStr() { return 1 == curRP ? "1" : curRP - 1 + "-" + curRP } function handleDRB(e, t, n) { if (n) { var i = new Point(e, t); f = new Point(i.x, i.y) } else { 1 !== zoomRate && (CY = getInt(getCompStyle(d("userTop"), "height")) + TBH, CX = getInt(getCompStyle(d("container"), "left"))); i = new Point(1 * (e - CX) / zoomRate, 1 * (t - CY) / zoomRate); f = new Point(i.x, i.y) } var o = p2p(PLT, PRT) / 2; SB = new Point(PLB.x + o, PRB.y); var r = p2p(PLT, SB); ST = new Point(PLT.x + o, PRT.y); var a = new Point(i.x, SB.y), s = p2p(SB, f); if (s > o) { var l = Math.asin(p2p(i, a) / s), u = Math.sin(l) * o, c = Math.cos(l) * o; f = new Point(f.x < SB.x ? SB.x - c : SB.x + c, f.y < SB.y ? SB.y - u : SB.y + u) } var g = p2p(ST, f); if (g > r) { var p = f.y - ST.y; l = Math.acos(p / g), u = Math.cos(l) * r, c = Math.sin(l) * r; f = new Point(f.x < SB.x ? SB.x - c : SB.x + c, ST.y + u) } var m = new Point(f.x, SB.y), h = p2p(f, PRB), v = p2p(f, m), x = Math.asin(.5 * v / (.5 * h)); ang = getInt(getDegree(x)); var y = 180 - (180 - 2 * ang); f.y > m.y && (y = -y); var b = .5 * h / Math.cos(x); y < 0 && (ang *= -1), x = getRadian(ang); var T = b - BOOKWIDTH / 2, P = CLIPDIFF - BY, B = P * Math.sin(x) + T * Math.cos(x), w = P * Math.cos(x) - T * Math.sin(x); divTurn(dragElement, f.x, f.y - BOOKHEIGHT, y), divTurn(clipElement, PRB.x - b, m.y - BOOKHEIGHT - CLIPDIFF, ang), divTurn(innerClip, B, w, -ang) } function handleDLB(e, t, n) { if (makeOne(), n) { var i = new Point(e, t); f = new Point(i.x, i.y) } else { 1 != zoomRate && (CY = getInt(getCompStyle(d("userTop"), "height")) + TBH, CX = getInt(getCompStyle(d("container"), "left"))); i = new Point(1 * (e - CX) / zoomRate, 1 * (t - CY) / zoomRate); f = new Point(i.x, i.y) } var o = p2p(PLT, PRT) / 2; SB = new Point(PLB.x + o, PRB.y); var r = p2p(PLT, SB); ST = new Point(PLT.x + o, PRT.y); var a = new Point(i.x, SB.y), s = p2p(SB, f); if (s > o) { var l = Math.asin(p2p(i, a) / s), u = Math.sin(l) * o, c = Math.cos(l) * o; f = new Point(f.x < SB.x ? SB.x - c : SB.x + c, f.y < SB.y ? SB.y - u : SB.y + u) } var g = p2p(ST, f); if (g > r) { var p = f.y - ST.y; l = Math.acos(p / g), u = Math.cos(l) * r, c = Math.sin(l) * r; f = new Point(f.x < SB.x ? SB.x - c : SB.x + c, ST.y + u) } var m = new Point(f.x, SB.y), h = p2p(f, PLB), v = p2p(f, m), x = Math.asin(.5 * v / (.5 * h)); ang = getInt(getDegree(x)); var y = 180 - (180 - 2 * ang); f.y > m.y && (y = -y); var b = .5 * h / Math.cos(x); y < 0 && (ang *= -1), x = getRadian(-ang); var T = -(b - (BOOKWIDTH / 2 + 2 * CLIPDIFF)), P = CLIPDIFF - BY, B = P * Math.sin(x) + T * Math.cos(x), w = P * Math.cos(x) - T * Math.sin(x); divTurn(dragElement, f.x - BOOKWIDTH / 2, f.y - BOOKHEIGHT, -y), divTurn(clipElement, PLB.x + b - (BOOKWIDTH / 2 + 2 * CLIPDIFF), m.y - BOOKHEIGHT - CLIPDIFF, -ang), divTurn(innerClip, B, w, ang) } function handleDLT(e, t, n) { if (makeOne(), n) { var i = new Point(e, t); f = new Point(i.x, i.y) } else { 1 != zoomRate && (CY = getInt(getCompStyle(d("userTop"), "height")) + TBH, CX = getInt(getCompStyle(d("container"), "left"))); i = new Point(1 * (e - CX) / zoomRate, 1 * (t - CY) / zoomRate); f = new Point(i.x, i.y) } var o = p2p(PLT, PRT) / 2; SB = new Point(PLT.x + o, PRT.y); var r = p2p(PLB, SB); ST = new Point(PLB.x + o, PRB.y); var a = new Point(i.x, SB.y), s = p2p(SB, f); if (s > o) { var l = Math.asin(p2p(i, a) / s), u = Math.sin(l) * o, c = Math.cos(l) * o; f = new Point(f.x < SB.x ? SB.x - c : SB.x + c, f.y < SB.y ? SB.y - u : SB.y + u) } var g = p2p(ST, f); if (g > r) { var p = f.y - ST.y; l = Math.acos(p / g), u = Math.cos(l) * r, c = Math.sin(l) * r; f = new Point(f.x < SB.x ? SB.x - c : SB.x + c, ST.y + u) } var m = new Point(f.x, SB.y), h = p2p(f, PLT), v = p2p(f, m), x = Math.asin(.5 * v / (.5 * h)); ang = getInt(getDegree(x)); var y = 180 - (180 - 2 * ang); f.y > m.y && (y = -y); var b = .5 * h / Math.cos(x); y < 0 && (ang *= -1), x = getRadian(-ang); var T = -(b - (BOOKWIDTH / 2 + 2 * CLIPDIFF)), P = CLIPDIFF - BY, B = P * Math.sin(x) + T * Math.cos(x), w = P * Math.cos(x) - T * Math.sin(x); divTurn(dragElement, f.x - BOOKWIDTH / 2, f.y, -y), divTurn(clipElement, PLB.x + b - (BOOKWIDTH / 2 + 2 * CLIPDIFF), m.y - CLIPDIFF, -ang), divTurn(innerClip, B, w, ang) } function handleDRT(e, t, n) { if (makeOne(), n) { var i = new Point(e, t); f = new Point(i.x, i.y) } else { 1 != zoomRate && (CY = getInt(getCompStyle(d("userTop"), "height")) + TBH, CX = getInt(getCompStyle(d("container"), "left"))); i = new Point(1 * (e - CX) / zoomRate, 1 * (t - CY) / zoomRate); f = new Point(i.x, i.y) } var o = p2p(PLT, PRT) / 2; SB = new Point(PLT.x + o, PRT.y); var r = p2p(PLB, SB); ST = new Point(PLB.x + o, PRB.y); var a = new Point(i.x, SB.y), s = p2p(SB, f); if (s > o) { var l = Math.asin(p2p(i, a) / s), u = Math.sin(l) * o, c = Math.cos(l) * o; f = new Point(f.x < SB.x ? SB.x - c : SB.x + c, f.y < SB.y ? SB.y - u : SB.y + u) } var g = p2p(ST, f); if (g > r) { var p = f.y - ST.y; l = Math.acos(p / g), u = Math.cos(l) * r, c = Math.sin(l) * r; f = new Point(f.x < SB.x ? SB.x - c : SB.x + c, ST.y + u) } var m = new Point(f.x, SB.y), h = p2p(f, PRT), v = p2p(f, m), x = Math.asin(.5 * v / (.5 * h)); ang = getInt(getDegree(x)); var y = 180 - (180 - 2 * ang); f.y > m.y && (y = -y); var b = .5 * h / Math.cos(x); y < 0 && (ang *= -1), x = getRadian(ang); var T = b - BOOKWIDTH / 2, P = CLIPDIFF - BY, B = P * Math.sin(x) + T * Math.cos(x), w = P * Math.cos(x) - T * Math.sin(x); divTurn(dragElement, f.x, f.y, y), divTurn(clipElement, PRB.x - b, m.y - CLIPDIFF, ang), divTurn(innerClip, B, w, -ang) } function showMasks() { z(rightMask, 2), z(leftMask, 2) } function hideMasks() { z(rightMask, -2), z(leftMask, -2) } function movePages(e) { showMasks(), hideShare(); var t = getScrollMX(e), n = getScrollMY(e); switch (dragBox) { case 1: if (!canMove("minus")) return; showDrags(), divOriginate(dragElement, BOOKWIDTH / 2, 0), divOriginate(clipElement, BOOKWIDTH / 2 + 2 * CLIPDIFF, CLIPDIFF), divOriginate(innerClip, BOOKWIDTH / 2 + 2 * CLIPDIFF, CLIPDIFF), handleDLT(t, n, !1); break; case 2: if (!canMove("plus")) return; showDrags(), divOriginate(dragElement, 0, 0), divOriginate(clipElement, 0, CLIPDIFF), divOriginate(innerClip, 0, CLIPDIFF), handleDRT(t, n, !1); break; case 3: if (!canMove("plus")) return; showDrags(), divOriginate(dragElement, 0, BOOKHEIGHT), divOriginate(clipElement, 0, BOOKHEIGHT + CLIPDIFF), divOriginate(innerClip, 0, BOOKHEIGHT + CLIPDIFF), handleDRB(t, n); break; case 4: if (!canMove("minus")) return; showDrags(), divOriginate(dragElement, BOOKWIDTH / 2, BOOKHEIGHT), divOriginate(clipElement, BOOKWIDTH / 2 + 2 * CLIPDIFF, BOOKHEIGHT + CLIPDIFF), divOriginate(innerClip, BOOKWIDTH / 2 + 2 * CLIPDIFF, BOOKHEIGHT + CLIPDIFF), handleDLB(t, n) } } function canMove(e) { if ("plus" === e) { if (pageCount % 2 == 0) { if (curRP + 1 > pageCount) return !1 } else if (curRP >= pageCount) return !1 } else if (1 === curRP) return !1; return !0 } function swipePages(e, t) { if (hideShare(), isTouch) { var n = null != e.target ? e.target : e.srcElement; "prev" == n.getAttribute("id") || "next" == n.getAttribute("id") || !(Math.abs(lastX - touchStartX) > TBH || Math.abs(lastY - touchStartY) > TBH) } new Array, new Array; switch (dragBox) { case 1: if (divOriginate(dragElement, BOOKWIDTH / 2, 0), divOriginate(clipElement, BOOKWIDTH / 2 + 2 * CLIPDIFF, CLIPDIFF), divOriginate(innerClip, BOOKWIDTH / 2 + 2 * CLIPDIFF, CLIPDIFF), !canMove("minus") || isTurning) return; isTouch ? (toAnimX = lastX, toAnimY = lastY) : (toAnimX = getScrollMX(e), toAnimY = getScrollMY(e)), toAnimX = toAnimX > bookX ? toAnimX : getInt(dragElement.style.left), isTurning = !0, f && -1 !== f.x || (f = new Point(PLT.x + 100, PLT.y + 50)); var i = p2p(f, PRT), o = f.y - PRT.y, r = PRT.x - f.x, a = Math.asin(o / i), s = i, d = f.x, l = f.y, u = window.setInterval(function () { s -= frameRate; var e = Math.cos(a) * s, t = Math.sin(a) * s; handleDLT(d + (r - e), l - (o - t), !0), s < 0 && (clearInterval(u), updateMethod("minus"), setDragBox(-1), isTurning = !1, hideDragsAnim(), updateSlides(), updateTweet(), f.x = -1), showDrags() }, speed); break; case 2: if (divOriginate(dragElement, 0, 0), divOriginate(clipElement, 0, CLIPDIFF), divOriginate(innerClip, 0, CLIPDIFF), !canMove("plus") || isTurning) return; isTouch ? (toAnimX = lastX, toAnimY = lastY) : (toAnimX = getScrollMX(e), toAnimY = getScrollMY(e)), toAnimX = toAnimX > bookX ? toAnimX : getInt(dragElement.style.left), isTurning = !0, f && -1 !== f.x || (f = new Point(PRT.x - 100, PRT.y + 50)); var c = p2p(f, PLT), g = f.y - PLT.y, p = f.x - PLT.x, m = Math.asin(g / c), h = c, v = f.x, x = f.y, y = window.setInterval(function () { h -= frameRate; var e = Math.cos(m) * h, t = Math.sin(m) * h; handleDRT(v - (p - e), x - (g - t), !0), showDrags(), h < 0 && (clearInterval(y), updateMethod("plus"), setDragBox(-1), hideDragsAnim(), updateSlides(), updateTweet(), isTurning = !1, f.x = -1), showDrags() }, speed); break; case 3: if (divOriginate(dragElement, 0, BOOKHEIGHT), divOriginate(clipElement, 0, BOOKHEIGHT + CLIPDIFF), divOriginate(innerClip, 0, BOOKHEIGHT + CLIPDIFF), !canMove("plus") || isTurning) return; isTouch ? (toAnimX = lastX, toAnimY = lastY) : (toAnimX = getScrollMX(e), toAnimY = getScrollMY(e)), toAnimX = toAnimX > bookX ? toAnimX : getInt(dragElement.style.left), isTurning = !0, f && -1 !== f.x || (f = new Point(PRB.x - 100, PRB.y - 50)); var b = p2p(f, PLB), T = PRB.y - f.y, P = f.x - PLB.x, B = Math.asin(T / b), w = b, C = f.x, I = f.y, S = window.setInterval(function () { w -= frameRate; var e = Math.cos(B) * w, t = Math.sin(B) * w; handleDRB(C - (P - e), I + (T - t), !0), showDrags(), w < 0 && (clearInterval(S), updateMethod("plus"), setDragBox(-1), hideDragsAnim(), updateSlides(), updateTweet(), isTurning = !1, f.x = -1), showDrags() }, speed); break; case 4: if (divOriginate(dragElement, BOOKWIDTH / 2, BOOKHEIGHT), divOriginate(clipElement, BOOKWIDTH / 2 + 2 * CLIPDIFF, BOOKHEIGHT + CLIPDIFF), divOriginate(innerClip, BOOKWIDTH / 2 + 2 * CLIPDIFF, BOOKHEIGHT + CLIPDIFF), !canMove("minus") || isTurning) return; isTouch ? (toAnimX = lastX, toAnimY = lastY) : (toAnimX = getScrollMX(e), toAnimY = getScrollMY(e)), toAnimX = toAnimX > bookX ? toAnimX : getInt(dragElement.style.left), isTurning = !0, f && -1 !== f.x || (f = new Point(PLB.x + 100, PLB.y - 50)); var D = p2p(f, PRB), O = PRB.y - f.y, R = PRB.x - f.x, M = Math.asin(O / D), E = D, k = f.x, H = f.y, L = window.setInterval(function () { E -= frameRate; var e = Math.cos(M) * E, t = Math.sin(M) * E; handleDLB(k + (R - e), H + (O - t), !0), E < 0 && (clearInterval(L), updateMethod("minus"), setDragBox(-1), isTurning = !1, hideDragsAnim(), updateSlides(), updateTweet(), f.x = -1), showDrags() }, speed) } } function onMouseMove(e) { if (null === e) e = window.event; movePages(e) } function turnEnd(e) { null !== dragElement && (swipePages(e, !0), document.onmousemove = null, document.onmouseup = null, document.onmousedown = null) } function pageURL(e, t) { return e } function makeDisplay(e, t) { e.style.display = t ? "inherit" : "none" } function makeInvisible(e, t) { t ? (e.style.display = "inherit", e.style.visibility = "visible") : e.style.visibility = "hidden" } function makeAdDisplay(e, t) { e.style.display = t ? "inherit" : "none" } function divStop(e) { for (var t = ["transform", "WebkitTransform", "msTransform", "MozTransform", "OTransform"], n = 0; n < t.length; n++)e.style[t[n]] = "none" } function divGradient(e, t) { e.style.backgroundImage = "-webkit-gradient(whatever)" } function keyNav(e) { 39 === e.keyCode ? canMove("plus") && (setDragBox(2), swipePages(e, !0)) : 37 === e.keyCode && canMove("minus") && (setDragBox(1), swipePages(e, !0)) } function zoomIn(e, t) { !isIos && t > .25 ? isIE && 9 == IEVersion ? ($("#" + e.id).css("width", $("#" + e.id).width() * t + "px"), $("#" + e.id).css("height", $("#" + e.id).height() * t + "px")) : (e.style.transform = "scale(" + t + ") translate3d(0,0,0)", e.style.MozTransform = "scale(" + t + ") translate3d(0,0,0)", e.style.msTransform = "scale(" + t + ") translate3d(0,0,0)", e.style.OTransform = "scale(" + t + ") translate3d(0,0,0)", e.style.webkitTransform = "scale(" + t + ") translate3d(0,0,0)") : (e.style.transform = "scale(" + t + ")", e.style.MozTransform = "scale(" + t + ")", e.style.msTransform = "scale(" + t + ")", e.style.OTransform = "scale(" + t + ")", e.style.webkitTransform = "scale(" + t + ")") } function setDragBox(e) { switch (dragBox = e, e) { case 1: updateDragClip("minus"); break; case 2: case 3: updateDragClip("plus"); break; case 4: updateDragClip("minus") } } function getScrollMX(e) { var t = t = e.clientX + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft); isTouch && (t = e.touches[0].pageX, lastX = t); var n = null !== e.target ? e.target : e.srcElement; return "prev" === n.getAttribute("id") || "backward" === n.getAttribute("id") ? PLT.x : "next" === n.getAttribute("id") || "forward" === n.getAttribute("id") ? PRT.x : t } function getScrollMY(e) { var t = e.clientY + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop); isTouch && (t = e.touches[0].pageY, lastY = t); var n = null !== e.target ? e.target : e.srcElement; return "prev" === n.getAttribute("id") || "backward" === n.getAttribute("id") ? PLT.y : "next" === n.getAttribute("id") || "forward" === n.getAttribute("id") ? PRT.y : t } function addVideoLink(e, t, n, i, o, r) { var a = document.createElement("input"); a.setAttribute("type", "button"), a.setAttribute("class", "videoLink"), a.setAttribute("onclick", "openVideoLink('" + r + "');"), addCSS(a, isIE ? "position:absolute; z-index:30; opacity:0.1; cursor:pointer;" : "position:absolute; z-index:30; cursor:pointer; background:none repeat scroll 0 0 transparent;"), divResize(a, n, i), divMove(a, e, t), a.style.borderStyle = "none", o.insertBefore(a, o.firstChild) } function addLink(e, t, n, i, o, r) { var a = document.createElement("input"); a.setAttribute("type", "button"), a.setAttribute("class", "link"), a.setAttribute("onclick", "window.open('" + r + "', '_blank');"), addCSS(a, isIE ? "position:absolute; z-index:30; opacity:0.1; cursor:pointer;" : "position:absolute; z-index:30; cursor:pointer; background:none repeat scroll 0 0 transparent;"), divResize(a, n, i), divMove(a, e, t), a.style.borderStyle = "none", o.insertBefore(a, o.firstChild) } function removeVideoLinks() { for (var e = document.getElementsByClassName("videoLink"), t = 0; t < e.length; t++){ (i = e.item(t)).parentNode.removeChild(i) } var n = document.getElementsByClassName("link"); for (t = 0; t < n.length; t++){ var i; (i = n.item(t)).parentNode.removeChild(i) } } function openVideoLink(e) { var t = document.getElementsByTagName("body")[0], n = document.createElement("iframe"); n.setAttribute("src", e), n.setAttribute("frameborder", "0"), n.setAttribute("allowfullscreen", ""), n.setAttribute("id", "youtubeVideo"), n.style.width = "640px", n.style.height = "360px", n.style.position = "fixed", n.style.margin = "-180px 0 0 -320px", n.style.top = "50%", n.style.left = "50%"; var i = document.createElement("div"); i.setAttribute("id", "videoOverlay"), i.setAttribute("onclick", "closeVideoLink();"), i.style.backgroundColor = "black", i.style.opacity = .9, i.style.position = "fixed", i.style.top = "0", i.style.left = "0", i.style.width = "100%", i.style.height = "100%", i.style.zIndex = "100", t.insertBefore(i, t.children[1]); var o = document.createElement("div"); o.style.backgroundColor = "white", o.id = "videoDiv", o.style.margin = "-200px 0 0 -340px", o.style.width = "680px", o.style.height = "400px", o.style.position = "fixed", o.style.top = "50%", o.style.left = "50%", o.style.zIndex = "150", o.style.opacity = 1, t.insertBefore(o, t.children[1]), o.appendChild(n); var r = document.createElement("a"); r.textContent = "close", r.setAttribute("href", "javascript:closeVideoLink();"), r.style.color = "red", r.style.fontSize = "20px", r.style.position = "relative", r.style.left = "630px", r.style.top = "-2px", r.style.textDecoration = "none", o.insertBefore(r, n) } function closeVideoLink() { var e = document.getElementById("videoOverlay"); null !== e && (null !== d("youtubeVideo") && (d("youtubeVideo").removeAttribute("src"), d("youtubeVideo").textContent = ""), e.textContent = "", e.parentNode.removeChild(e), null !== (e = document.getElementById("videoDiv")) && (e.textContent = "", e.parentNode.removeChild(e))) }